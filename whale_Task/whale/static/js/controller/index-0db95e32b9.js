whaleModule.controller("indexController",["$scope","$rootScope","$window","$http","$interval","$location","$timeout","$state",function(e,r,o,a,t,n,d,l){e.data={account:"",phone:"",YZM:""},a.get("/whaleApiMgr/taskReward/selectTaskRewardFirst").success(function(r){10200==r.code&&(e.order=r.data,e.picloading=!1)}),e.renLing=function(r){whale.removestore("sendtime1"),whale.store("rewardId",r),e.errorWen="",e.errorFlag=!1,e.data={account:"",phone:"",YZM:""}},whale.removestore("sendtime1"),e.sendYZM=function(){if(whale.store("sendtime1"))return!1;if(!(e.data.phone&&e.data.phone.length>0))return e.errorWen="请输入手机号码",void(e.errorFlag=!0);if(!whale.phone_bat.test(e.data.phone))return e.errorWen="你输入的手机号码格式不正确，请重新输入",void(e.errorFlag=!0);e.errorFlag=!1;var r=$("#YZM1"),o={params:{Phone:e.data.phone}};a.get("/account/applycontroller/sendMsgCode",o).success(function(o){function a(){t>0?(t--,r.html(t+"s")):(r.html("重新发送"),clearInterval(n),whale.removestore("sendtime1"))}if(10200===o.code){whale.store("sendtime1","no"),e.errorWen="发送成功，请注意查收",e.errorFlag=!0;var t=60,n=setInterval(a,1e3)}else 10010===o.code?(e.errorWen="发送验证码失败",e.errorFlag=!0):10009===o.code?(e.errorWen=o.note,e.errorFlag=!0):(e.errorWen="网络错误，请稍后重试",e.errorFlag=!0)}).error(function(){e.errorWen="网络错误，请稍后重试",e.errorFlag=!0})},e.submit=function(){if(!(e.data.account&&e.data.account.length>0))return e.errorWen="请输入用户名",void(e.errorFlag=!0);if(!(e.data.phone&&e.data.phone.length>0))return e.errorWen="请输入手机号码",void(e.errorFlag=!0);if(!whale.phone_bat.test(e.data.phone))return e.errorWen="你输入的手机号码格式不正确，请重新输入",void(e.errorFlag=!0);if(e.errorFlag=!1,!(e.data.YZM&&e.data.YZM.length>0))return e.errorWen="请输入验证码",void(e.errorFlag=!0);if(!/^([0-9]{6}$)/.test(e.data.YZM))return e.errorWen="你输入的验证码格式不正确，请重新输入",void(e.errorFlag=!0);e.errorFlag=!1;var r={name:e.data.account,phone:e.data.phone,rewardId:whale.store("rewardId"),code:e.data.YZM};a.post("/whaleApiMgr/taskReward/addtaskRegister",r).success(function(r){if(10200!=r.code)return e.errorWen=r.note,void(e.errorFlag=!0);e.errorWen="认领成功",e.errorFlag=!0,$("#myModalTip").modal("hide"),e.picloading=!0,a.get("/whaleApiMgr/taskReward/selectTaskRewardFirst").success(function(r){10200==r.code&&(e.order=r.data,e.picloading=!1)})})}}]);